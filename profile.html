<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CrownForge | Neural Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;900&family=Plus+Jakarta+Sans:wght@400;600&display=swap" rel="stylesheet" />

<style>
:root {
  --neon-cyan: #00f2ff;
  --neon-pink: #ff00c8;
  --bg-dark: #02040a;
  --glass: rgba(255, 255, 255, 0.05);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Plus Jakarta Sans', sans-serif;
  background-color: var(--bg-dark);
  background-image: 
    radial-gradient(circle at 10% 10%, rgba(0, 242, 255, 0.1) 0%, transparent 40%),
    radial-gradient(circle at 90% 90%, rgba(255, 0, 200, 0.1) 0%, transparent 40%);
  color: #fff;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

/* --- HEXAGON BACKGROUND LAYER --- */
.bg-grid {
  position: fixed; inset: 0;
  background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
  opacity: 0.2;
  z-index: -1;
}

/* --- PROFILE CARD --- */
.card {
  position: relative;
  width: 90%;
  max-width: 440px;
  background: rgba(2, 4, 10, 0.85);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 30px;
  padding: 50px 35px;
  text-align: center;
  box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
  animation: cardFade 0.8s ease-out;
}

@keyframes cardFade {
  from { opacity: 0; transform: translateY(30px) scale(0.95); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* --- AVATAR GLOW --- */
.avatar-container {
  position: relative;
  width: 130px;
  height: 130px;
  margin: 0 auto 25px;
}

.avatar-glow {
  position: absolute;
  top: -5px; left: -5px; right: -5px; bottom: -5px;
  border-radius: 50%;
  background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink));
  animation: rotateGlow 4s linear infinite;
  opacity: 0.6;
  filter: blur(5px);
}

@keyframes rotateGlow {
  to { transform: rotate(360deg); }
}

.profile-pic {
  position: relative;
  width: 100%; height: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid var(--bg-dark);
  z-index: 2;
  cursor: pointer;
  transition: 0.4s;
}

.profile-pic:hover { transform: scale(1.03); filter: brightness(1.1); }

/* --- TEXT & INFO --- */
h2 {
  font-family: 'Orbitron', sans-serif;
  font-size: 1.4rem;
  letter-spacing: 2px;
  text-transform: uppercase;
  background: linear-gradient(to right, #fff, var(--neon-cyan));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 25px;
}

.info-row {
  margin-bottom: 15px;
  text-align: left;
}

.info-label {
  font-size: 0.7rem;
  color: var(--neon-cyan);
  font-family: 'Orbitron';
  margin-bottom: 5px;
  display: block;
}

.email-txt { font-weight: 600; font-size: 0.95rem; color: #fff; }

.uid-box {
  background: rgba(255, 255, 255, 0.05);
  border: 1px dashed rgba(255, 255, 255, 0.2);
  padding: 8px 12px;
  border-radius: 10px;
  font-family: monospace;
  font-size: 0.75rem;
  color: rgba(255, 255, 255, 0.5);
  margin-top: 5px;
}

/* --- INPUTS --- */
input, textarea {
  width: 100%;
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 14px;
  padding: 14px;
  color: #fff;
  font-size: 0.9rem;
  outline: none;
  transition: 0.3s;
  margin-top: 8px;
}

input:focus, textarea:focus {
  border-color: var(--neon-cyan);
  background: rgba(0, 242, 255, 0.05);
  box-shadow: 0 0 15px rgba(0, 242, 255, 0.15);
}

/* --- BUTTONS --- */
.primary-btn {
  width: 100%;
  padding: 16px;
  border-radius: 15px;
  border: none;
  background: linear-gradient(135deg, var(--neon-cyan), var(--neon-pink));
  color: #000;
  font-family: 'Orbitron';
  font-weight: 900;
  cursor: pointer;
  margin-top: 25px;
  transition: 0.4s;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.primary-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 30px rgba(0, 242, 255, 0.4);
}

.logout-btn {
  background: transparent;
  color: #ff4d4d;
  border: 1px solid #ff4d4d;
  margin-top: 15px;
  font-family: 'Orbitron';
  font-size: 0.75rem;
  padding: 10px;
  cursor: pointer;
  border-radius: 10px;
  width: 100%;
  transition: 0.3s;
}

.logout-btn:hover { background: rgba(255, 77, 77, 0.1); }

.save-msg {
  position: absolute;
  bottom: -40px;
  left: 0; width: 100%;
  font-size: 0.8rem;
  color: var(--neon-cyan);
  opacity: 0;
  transition: 0.5s;
}
.save-msg.show { opacity: 1; bottom: 10px; }

input[type="file"] { display: none; }
</style>
</head>

<body>
<div class="bg-grid"></div>

<div class="card">
  <div class="avatar-container">
    <div class="avatar-glow"></div>
    <img id="profilePic" class="profile-pic" src="https://i.imgur.com/5QH1XGQ.png" alt="Profile">
  </div>
  <input type="file" id="fileInput" accept="image/*">

  <h2>Neural Profile</h2>

  <div class="info-row">
    <span class="info-label">Connected Email</span>
    <p class="email-txt" id="userEmail">Loading...</p>
  </div>

  <div class="info-row">
    <span class="info-label">Unique Identity (UID)</span>
    <div class="uid-box" id="userUID">Fetching Signal...</div>
  </div>

  <div class="info-row">
    <span class="info-label">Combat Name</span>
    <input type="text" id="displayName" placeholder="Forge Name">
  </div>

  <div class="info-row">
    <span class="info-label">Citizen Bio</span>
    <textarea id="userBio" placeholder="Tell the studio about your skills..."></textarea>
  </div>

  <button class="primary-btn" id="saveChanges">Update Interface</button>
  <button class="logout-btn" id="logoutBtn">Disconnect Session</button>
  
  <p class="save-msg" id="saveMsg">CORE UPDATED âœ…</p>
</div>

<script type="module">
/* --- Aapka existing Firebase logic yahan perfectly kaam karega --- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, updateProfile, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyDNy1J7zVJMLGLsyUxRT1EIaIBruI_p2G8",
  authDomain: "crownforgestudio-2581a.firebaseapp.com",
  projectId: "crownforgestudio-2581a",
  storageBucket: "crownforgestudio-2581a.appspot.com",
  messagingSenderId: "223324386293",
  appId: "1:223324386293:web:9d7919c6b2e93781b026bc"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const storage = getStorage(app);

const emailEl = document.getElementById("userEmail");
const uidEl = document.getElementById("userUID");
const nameEl = document.getElementById("displayName");
const bioEl = document.getElementById("userBio");
const saveMsg = document.getElementById("saveMsg");
const picEl = document.getElementById("profilePic");
const fileInput = document.getElementById("fileInput");

onAuthStateChanged(auth, async (user) => {
  if (!user) return (window.location.href = "index.html");
  emailEl.textContent = user.email;
  uidEl.textContent = user.uid;
  nameEl.value = user.displayName || "";

  const snap = await getDoc(doc(db, "users", user.uid));
  if (snap.exists()) {
    bioEl.value = snap.data().bio || "";
    if (snap.data().photoURL) picEl.src = snap.data().photoURL;
  }
});

document.getElementById("saveChanges").onclick = async () => {
  const user = auth.currentUser;
  if (!user) return;
  try {
    await updateProfile(user, { displayName: nameEl.value });
    await setDoc(doc(db, "users", user.uid), { bio: bioEl.value }, { merge: true });
    saveMsg.classList.add("show");
    setTimeout(() => saveMsg.classList.remove("show"), 3000);
  } catch (err) { alert(err.message); }
};

picEl.onclick = () => fileInput.click();
fileInput.onchange = async (e) => {
  const file = e.target.files[0];
  const user = auth.currentUser;
  if (!file || !user) return;
  try {
    const imgRef = ref(storage, `profilePics/${user.uid}`);
    await uploadBytes(imgRef, file);
    const url = await getDownloadURL(imgRef);
    await updateProfile(user, { photoURL: url });
    await setDoc(doc(db, "users", user.uid), { photoURL: url }, { merge: true });
    picEl.src = url;
  } catch (err) { alert(err.message); }
};

document.getElementById("logoutBtn").onclick = async () => {
  await signOut(auth);
  window.location.href = "index.html";
};
</script>
</body>
</html>